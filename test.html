<!DOCTYPE html>
<html>
<head>
    <title>–û–Ω–ª–∞–π–Ω-–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ - –¢–µ—Å—Ç</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .book { border: 1px solid #ddd; padding: 15px; margin: 10px; border-radius: 8px; }
        .search { margin: 20px 0; padding: 10px; }
    </style>
</head>
<body>
    <h1>üìö –û–Ω–ª–∞–π–Ω-–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ - –¢–µ—Å—Ç–æ–≤–∞ –≤–µ—Ä—Å—ñ—è</h1>
    
    <div class="search">
        <input type="text" id="searchInput" placeholder="–ü–æ—à—É–∫ –∫–Ω–∏–≥...">
        <button onclick="loadBooks()">–ü–æ—à—É–∫</button>
        <button onclick="loadGenres()">–ñ–∞–Ω—Ä–∏</button>
        <button onclick="loadPopular()">–ü–æ–ø—É–ª—è—Ä–Ω—ñ</button>
    </div>

    <div id="results"></div>

    <script>
        async function loadBooks() {
            try {
                const query = document.getElementById('searchInput').value;
                const url = query ? `/books/search/advanced?query=${query}` : '/books';
                
                const response = await fetch('http://localhost:5000' + url);
                const books = await response.json();
                
                displayBooks(books);
            } catch (error) {
                document.getElementById('results').innerHTML = 
                    '<p style="color: red;">–ü–æ–º–∏–ª–∫–∞: ' + error + '</p>';
            }
        }

        async function loadGenres() {
            try {
                const response = await fetch('http://localhost:5000/books/genres');
                const genres = await response.json();
                
                document.getElementById('results').innerHTML = 
                    '<h3>–ñ–∞–Ω—Ä–∏:</h3><ul>' + 
                    genres.map(genre => `<li>${genre}</li>`).join('') + 
                    '</ul>';
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞:', error);
            }
        }

        async function loadPopular() {
            try {
                const response = await fetch('http://localhost:5000/books/popular');
                const books = await response.json();
                displayBooks(books);
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞:', error);
            }
        }

        function displayBooks(books) {
            const booksHTML = books.map(book => `
                <div class="book">
                    <h3>${book.title}</h3>
                    <p><strong>–ê–≤—Ç–æ—Ä:</strong> ${book.author}</p>
                    <p><strong>–†—ñ–∫:</strong> ${book.year} | <strong>–ñ–∞–Ω—Ä:</strong> ${book.genre}</p>
                    <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ${book.rating} ‚≠ê (${book.reviews_count} –≤—ñ–¥–≥—É–∫—ñ–≤)</p>
                    <p>${book.description}</p>
                    ${book.cover_url ? `<img src="${book.cover_url}" width="100">` : ''}
                </div>
            `).join('');
            
            document.getElementById('results').innerHTML = 
                `<h3>–ó–Ω–∞–π–¥–µ–Ω–æ –∫–Ω–∏–≥: ${books.length}</h3>` + booksHTML;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–Ω–∏–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
        loadBooks();
    </script>
</body>
</html>